<div ng-controller="selectSelectasController">
    <h2>Select <b>as</b> (lazy loading case)</h2>
    <div class="row">
        <div class="col-md-8">
            <oi-select
                oi-options="item.id as item.name for item in shopArrFn($query, $selectedAs)"
                ng-model="bundle"
                multiple
                placeholder="Select"
                oi-select-options="{
                    newItem: true,
                    newItemFn: 'addItem($query)',
                    removeItemFn: 'removeItem($item)'
                }"
                ></oi-select>
        </div>
    </div>
<div class="row">
<div class="col-md-8">
<div hljs>
oi-options="item.id as item.name for item in shopArrFn($query, $selectedAs)"
ng-model="bundle"
multiple
oi-select-options="{
    newItem: true,
    newItemFn: 'addItem($query)',
    removeItemFn: 'removeItem($item)'
}"
</div>
    <p>Example how to get elements by id and create new in database</p>
<div hljs>
$scope.shopArrFn = function(query, selectedAs) {
    if (querySelectAs) {
        return getOptionsById(selectedAs); //promise
    } else {
        return findOptions(query); //promise
    }
};
</div>
<div hljs>
$scope.addItem = function(query) {
    return createOption(query); //promise
};
</div>
<div hljs>
$scope.removeItem = function(item) {
    return removeOption(item); //promise
};
</div>
    <p>You can optimize this case and don't request all selected items when the new item has been added</p>
</div>
<div class="col-md-4"><pre>
{{bundle}}
</pre></div>
</div>
</div>